# BaseBallGameData Prediction
# 目標
藉由抓取中華職棒球員比賽資料來分析預測下一期球員卡會變強的球員
# 前言
在全民打棒球pro這款遊戲中會依照每年中華職棒球員比賽成績來做球員卡的素質
<div style="text-align: center">
<img src="https://i.imgur.com/Tl12g4j.jpg"/>
</div>

<center>(圖片截至於遊戲內)</center>

其中Live卡素質會針對2020年各月表現超群的投打手們每兩周一次boost調整素質，所以可以藉由官方給的參考項目預測下一期會調整素質的球員
![](https://i.imgur.com/Nbfd3KE.jpg)
打者:打數(AB)、安打(H)、打點(RBI)、全壘打(HR)、盜壘(SB)、四壞保送(BB)、得分( R )
投手:局數(IP)、勝(W)、敗(L)、救援(SV)、奪三振(SO)、中繼(HLD)、四壞(BB)、失分( R )
藉由提前知道哪幾個球員會變動可以先在自由球員市場購買，趁著價錢還沒上漲先買下好的球員，也可以當作是個投資在低點買進高價賣出(就很像是股票XD)，所以為了能準確預測而有了這個專案，不過這個專案也是個紀錄，說不定今年新球季會不太一樣

# 做法
### 步驟1 - 爬蟲與資料整理
首先要先找到球員資料，所以我從 [http://www.cpbl.com.tw/web/team_player.php?&team=L01](http://www.cpbl.com.tw/web/team_player.php?&team=L01) 這個網站利用爬蟲的方式把球員名字與成績抓下來，這網站是中華職棒的官方網站，一開始的時候發現有球員每月比賽成績
![](https://i.imgur.com/29ZtytG.jpg)
只要把當月的資料抓下來就好，但是後來發現這個表格的資料不夠，少了幾項要的素質，所以改抓取逐場成績表的成績，再依月份分類把的成績加總就變成我要的資料再做成json檔儲存
![](https://i.imgur.com/eNxCAbo.jpg)

### 步驟二 - 資料整理
有了這個資料之後我再抓出其中幾個有加權計算的紀錄，像是打者方面就是打數、安打、打點、全壘打、盜壘、四壞保送、得分，然後
做成numpy的矩陣形式做計算

![](https://i.imgur.com/lXXPTNz.jpg)

### 步驟三 - 分析
經由官方給的總分可以跟我抓下來的數據弄成一個方程式，例如:索沙 = $$27\times x_1+3\times x_2+0\times x_3+0\times x_4+33\times x_5+4\times x_6+0\times x_7+16\times x_8 = 854.1$$x就是每個數據的權重，算出x在代回每個球員就能得到當期球員的分數，那因為官方只有釋出打者跟投手成績高的前三名，而且投手跟打者是分開計算，所以我先用統一4、5、6月打者共9項的資料，在經由計算反矩陣的方式算出x，8個未知數只要8個方程式就能算出來，因此9個方程式隨機選了8個做運算，多做幾次當驗算，不太確定是否每一隊都用同樣的權重，所以也代入其他隊的資料看看有沒有跟官方給的分數一樣，最後算出來的就是下面那樣
![](https://i.imgur.com/xbqZfKX.jpg)
$$(R,AB,RBI,H,HR,BB,SB) = (5,1,10,15,35,5,10)$$$$ 657 = 5\times10+1\times62+10\times9+15\times22+35\times3+5\times4+10\times0$$投手部分因為驗算之後對不上，數值算出來為無理數，所以還在想為什麼是不是要改變算法

### 結論
我在做這個分析預測的時候遊戲官方還沒釋出7月的總分，所以我也把7月的分數當作驗算，先算出了四隊全隊的分數等待成績出來，過幾天後成績出來發現四隊打者分數排名都跟我所計算的一樣
![](https://i.imgur.com/fgUGX7c.jpg)
這能確定至少這幾個月都是用這個權重，能夠用這個數值算出後幾個月的球員成績，不過也要繼續驗證確認遊戲公司沒有改變計算方式，我覺得經過計算這個預測也能對每位球員的表現好壞有了數值上的了解跟排名，能夠知道誰的表現最好

### 能改善的地方
* 在程式碼方面我把每個球隊的程式碼分開但是因為其實有很多相同的地方可以刪減成一個程式就好
* 可能可以在改變更輕易爬取到所有資料的網站
* 投手部分的權重

1st 更新日期 :2020/01/29
2nd 更新日期 :2020/01/31
